{{ define "perfil.html" }}
<!DOCTYPE html>
<html lang="{{ .Lang }}">
<head>
    <meta charset="UTF-8">
    <title>{{ t .Lang "nav.profile" }} - {{ t .Lang "app.title" }}</title>
    {{ template "styles-private" . }}
    <link rel="stylesheet" href="/static/css/perfil-ajustos.css">
</head>
<body>
    {{ template "header-private" . }}
    {{ template "menu" . }}

    <main class="contingut-principal">
        <section class="perfil-ajustos">
            <header class="perfil-ajustos-capcalera">
                <h1>{{ t .Lang "profile.title" }}</h1>
                <p>{{ t .Lang "profile.subtitle" }}</p>
            </header>

            {{ if .Data.Error }}
            <div class="alert alert-error" role="alert">{{ .Data.Error }}</div>
            {{ end }}
            {{ if .Data.Success }}
            <div class="alert alert-success" role="alert">{{ .Data.Success }}</div>
            {{ end }}

            {{ $tab := .Data.ActiveTab }}
            <div class="perfil-ajustos-tabs">
                <div class="tabs-botons" role="tablist" aria-label="{{ t .Lang "profile.title" }}">
                    <button class="tab-boto {{ if eq $tab "generals" }}actiu{{ end }}" data-tab="generals" role="tab" aria-selected="{{ if eq $tab "generals" }}true{{ else }}false{{ end }}" aria-controls="tab-generals">
                        <i class="fas fa-id-card"></i>
                        <span>{{ t .Lang "profile.tab.general" }}</span>
                    </button>
                    <button class="tab-boto {{ if eq $tab "activitat" }}actiu{{ end }}" data-tab="activitat" role="tab" aria-selected="{{ if eq $tab "activitat" }}true{{ else }}false{{ end }}" aria-controls="tab-activitat">
                        <i class="fas fa-trophy"></i>
                        <span>{{ t .Lang "points.menu" }}</span>
                    </button>
                    <button class="tab-boto {{ if eq $tab "contrasenya" }}actiu{{ end }}" data-tab="contrasenya" role="tab" aria-selected="{{ if eq $tab "contrasenya" }}true{{ else }}false{{ end }}" aria-controls="tab-contrasenya">
                        <i class="fas fa-lock"></i>
                        <span>{{ t .Lang "profile.tab.password" }}</span>
                    </button>
                    <button class="tab-boto {{ if eq $tab "privacitat" }}actiu{{ end }}" data-tab="privacitat" role="tab" aria-selected="{{ if eq $tab "privacitat" }}true{{ else }}false{{ end }}" aria-controls="tab-privacitat">
                        <i class="fas fa-user-shield"></i>
                        <span>{{ t .Lang "profile.tab.privacy" }}</span>
                    </button>
                    <button class="tab-boto tab-danger {{ if eq $tab "eliminar" }}actiu{{ end }}" data-tab="eliminar" role="tab" aria-selected="{{ if eq $tab "eliminar" }}true{{ else }}false{{ end }}" aria-controls="tab-eliminar">
                        <i class="fas fa-user-slash"></i>
                        <span>{{ t .Lang "profile.tab.delete" }}</span>
                    </button>
                </div>

                <div class="tabs-contingut">
                    <!-- Pestanya: Dades generals -->
                    <section id="tab-generals" class="tab-pane {{ if eq $tab "generals" }}actiu{{ end }}" role="tabpanel" aria-labelledby="tab-generals">
                        <form id="form-dades-generals" class="form-dades" method="post" action="/perfil/dades">
                            <input type="hidden" name="csrf_token" value="{{ .Data.CSRFToken }}">
                            <div class="fila-camp">
                                <div class="camp-label">
                                    <label for="camp-nom">{{ t .Lang "profile.field.name" }}</label>
                                    <p class="camp-helper">{{ t .Lang "profile.helper.name" }}</p>
                                </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-nom" name="nom" value="{{ if .Data.User }}{{ .Data.User.Name }}{{ end }}" autocomplete="given-name">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="nom_visibility" value="public" {{ if eq .Data.Privacy.NomVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="nom_visibility" value="private" {{ if or (eq .Data.Privacy.NomVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-cognoms">{{ t .Lang "profile.field.surname" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-cognoms" name="cognoms" value="{{ if .Data.User }}{{ .Data.User.Surname }}{{ end }}" autocomplete="family-name">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="cognoms_visibility" value="public" {{ if eq .Data.Privacy.CognomsVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="cognoms_visibility" value="private" {{ if or (eq .Data.Privacy.CognomsVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-usuari">{{ t .Lang "profile.field.username" }}</label>
                                        <p class="camp-helper">{{ t .Lang "profile.helper.username" }}</p>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-usuari" name="usuari" value="{{ if .Data.User }}{{ .Data.User.Usuari }}{{ end }}" readonly>
                                    </div>
                                    <div class="camp-privacitat camp-privacitat-desactivada">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <span class="text-desactivat">{{ t .Lang "profile.helper.visibilityLocked" }}</span>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-correu">{{ t .Lang "profile.field.email" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="email" id="camp-correu" name="correu" value="{{ if .Data.User }}{{ .Data.User.Email }}{{ end }}" autocomplete="email">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="correu_visibility" value="public" {{ if eq .Data.Privacy.EmailVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="correu_visibility" value="private" {{ if or (eq .Data.Privacy.EmailVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-naixement">{{ t .Lang "profile.field.birthdate" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="date" id="camp-naixement" name="data_naixement" value="{{ .Data.BirthInputValue }}" autocomplete="bday">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="naixement_visibility" value="public" {{ if eq .Data.Privacy.BirthVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="naixement_visibility" value="private" {{ if or (eq .Data.Privacy.BirthVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-pais">{{ t .Lang "profile.field.country" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-pais" name="pais" value="{{ if .Data.User }}{{ .Data.User.Pais }}{{ end }}" autocomplete="country-name">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="pais_visibility" value="public" {{ if or (eq .Data.Privacy.PaisVisibility "public") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="pais_visibility" value="private" {{ if eq .Data.Privacy.PaisVisibility "private" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-estat">{{ t .Lang "profile.field.state" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-estat" name="estat" value="{{ if .Data.User }}{{ .Data.User.Estat }}{{ end }}" autocomplete="address-level1">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="estat_visibility" value="public" {{ if eq .Data.Privacy.EstatVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="estat_visibility" value="private" {{ if or (eq .Data.Privacy.EstatVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-provincia">{{ t .Lang "profile.field.province" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-provincia" name="provincia" value="{{ if .Data.User }}{{ .Data.User.Provincia }}{{ end }}" autocomplete="address-level2">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="provincia_visibility" value="public" {{ if eq .Data.Privacy.ProvinciaVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="provincia_visibility" value="private" {{ if or (eq .Data.Privacy.ProvinciaVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-poblacio">{{ t .Lang "profile.field.city" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-poblacio" name="poblacio" value="{{ if .Data.User }}{{ .Data.User.Poblacio }}{{ end }}" autocomplete="address-level2">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="poblacio_visibility" value="public" {{ if eq .Data.Privacy.PoblacioVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="poblacio_visibility" value="private" {{ if or (eq .Data.Privacy.PoblacioVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-codi-postal">{{ t .Lang "profile.field.postal" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-codi-postal" name="codi_postal" value="{{ if .Data.User }}{{ .Data.User.CodiPostal }}{{ end }}" autocomplete="postal-code">
                                    </div>
                                <div class="camp-privacitat">
                                    <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                    <label class="radio-pill">
                                        <input type="radio" name="codi_postal_visibility" value="public" {{ if eq .Data.Privacy.PostalVisibility "public" }}checked{{ end }}>
                                        <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="codi_postal_visibility" value="private" {{ if or (eq .Data.Privacy.PostalVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-adreca">{{ t .Lang "profile.field.address" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-adreca" name="adreca" value="{{ if .Data.User }}{{ .Data.User.Address }}{{ end }}" autocomplete="street-address">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="adreca_visibility" value="public" {{ if eq .Data.Privacy.AddressVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="adreca_visibility" value="private" {{ if or (eq .Data.Privacy.AddressVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-situacio">{{ t .Lang "profile.field.employment" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        {{ $emp := .Data.User.Employment }}
                                        <select id="camp-situacio" name="situacio_laboral">
                                            <option value="">{{ t .Lang "profile.option.none" }}</option>
                                            <option value="actiu" {{ if eq $emp "actiu" }}selected{{ end }}>{{ t .Lang "profile.employment.active" }}</option>
                                            <option value="parat" {{ if eq $emp "parat" }}selected{{ end }}>{{ t .Lang "profile.employment.unemployed" }}</option>
                                            <option value="jubilat" {{ if eq $emp "jubilat" }}selected{{ end }}>{{ t .Lang "profile.employment.retired" }}</option>
                                            <option value="estudiant" {{ if eq $emp "estudiant" }}selected{{ end }}>{{ t .Lang "profile.employment.student" }}</option>
                                            <option value="altre" {{ if eq $emp "altre" }}selected{{ end }}>{{ t .Lang "profile.employment.other" }}</option>
                                        </select>
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="situacio_visibility" value="public" {{ if eq .Data.Privacy.EmploymentVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="situacio_visibility" value="private" {{ if or (eq .Data.Privacy.EmploymentVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-professio">{{ t .Lang "profile.field.profession" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="text" id="camp-professio" name="professio" value="{{ if .Data.User }}{{ .Data.User.Profession }}{{ end }}">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="professio_visibility" value="public" {{ if eq .Data.Privacy.ProfessionVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="professio_visibility" value="private" {{ if or (eq .Data.Privacy.ProfessionVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-telefon">{{ t .Lang "profile.field.phone" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        <input type="tel" id="camp-telefon" name="telefon" value="{{ if .Data.User }}{{ .Data.User.Phone }}{{ end }}" autocomplete="tel">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="telefon_visibility" value="public" {{ if eq .Data.Privacy.PhoneVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="telefon_visibility" value="private" {{ if or (eq .Data.Privacy.PhoneVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-idioma-preferit">{{ t .Lang "profile.field.preferredLang" }}</label>
                                    </div>
                                    <div class="camp-input">
                                        {{ $pref := .Data.User.PreferredLang }}
                                        <select id="camp-idioma-preferit" name="idioma_preferit">
                                            <option value="">{{ t .Lang "profile.option.none" }}</option>
                                            {{ range $opt := .Data.LangOptions }}
                                            <option value="{{ $opt }}" {{ if eq $pref $opt }}selected{{ end }}>{{ t $.Lang (printf "lang.name.%s" $opt) }}</option>
                                            {{ end }}
                                        </select>
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="idioma_preferit_visibility" value="public" {{ if eq .Data.Privacy.PreferredLangVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="idioma_preferit_visibility" value="private" {{ if or (eq .Data.Privacy.PreferredLangVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="fila-camp">
                                    <div class="camp-label">
                                        <label for="camp-idiomes-parla">{{ t .Lang "profile.field.languagesSpoken" }}</label>
                                        <p class="camp-helper">{{ t .Lang "profile.field.languagesSpoken.helper" }}</p>
                                    </div>
                                    <div class="camp-input">
                                        <div id="tags-idiomes" class="tags-input">
                                            <ul class="tags-llista"></ul>
                                            <input type="text" id="idiomes_parla_input" placeholder="{{ t .Lang "profile.field.languagesSpoken.placeholder" }}">
                                            <ul class="tags-suggestions"></ul>
                                        </div>
                                        <input type="hidden" id="idiomes_parla_hidden" name="idiomes_parla" value="{{ if .Data.User }}{{ .Data.User.SpokenLangs }}{{ end }}">
                                    </div>
                                    <div class="camp-privacitat">
                                        <span class="badge-privacitat">{{ t .Lang "profile.visibility" }}</span>
                                        <label class="radio-pill">
                                            <input type="radio" name="idiomes_parla_visibility" value="public" {{ if eq .Data.Privacy.SpokenLangsVisibility "public" }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.public" }}</span>
                                        </label>
                                        <label class="radio-pill">
                                            <input type="radio" name="idiomes_parla_visibility" value="private" {{ if or (eq .Data.Privacy.SpokenLangsVisibility "private") (not .Data.Privacy) }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.visibility.private" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="form-accio">
                                    <button type="submit" class="boto-primari">
                                        <i class="fas fa-save"></i>
                                        <span>{{ t .Lang "profile.action.save" }}</span>
                                    </button>
                                </div>

                            <!-- Estadístiques d'activitat -->
                            <section class="perfil-ajustos-estadistiques">
                                <header class="estadistiques-capcalera">
                                    <div>
                                        <h2>{{ t .Lang "profile.stats.title" }}</h2>
                                        <p class="camp-helper">{{ t .Lang "profile.stats.subtitle" }}</p>
                                    </div>
                                    <div class="estadistiques-metadades">
                                        <p class="member-since">
                                            {{ t .Lang "profile.stats.memberSince" }} <strong>{{ .Data.MemberSinceDisplay }}</strong>
                                        </p>
                                        <label class="toggle-inline">
                                            <input type="checkbox" name="mostrar_estadistiques_public" {{ if or (not .Data.Privacy) .Data.Privacy.ShowActivity }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.stats.showPublic" }}</span>
                                        </label>
                                    </div>
                                </header>

                                <div class="heatmap-legenda">
                                    <span>{{ t .Lang "profile.stats.less" }}</span>
                                    <div class="heatmap-gradient">
                                        <span class="heatmap-swatch nivell-0"></span>
                                        <span class="heatmap-swatch nivell-1"></span>
                                        <span class="heatmap-swatch nivell-2"></span>
                                        <span class="heatmap-swatch nivell-3"></span>
                                        <span class="heatmap-swatch nivell-4"></span>
                                    </div>
                                    <span>{{ t .Lang "profile.stats.more" }}</span>
                                </div>

                                <div class="heatmap-container">
                                    <div class="heatmap-grid" aria-hidden="true">
                                        <div class="heatmap-dia" data-level="0"></div>
                                        <div class="heatmap-dia" data-level="1"></div>
                                        <div class="heatmap-dia" data-level="2"></div>
                                        <div class="heatmap-dia" data-level="3"></div>
                                        <div class="heatmap-dia" data-level="4"></div>
                                    </div>
                                </div>

                                <p class="estadistiques-resum">
                                    <strong>{{ t .Lang "profile.stats.summary" }}</strong> 0 (exemple).
                                </p>
                            </section>
                            </form>
                        </section>

                        <!-- Pestanya: Contrasenya -->
                        <section id="tab-activitat" class="tab-pane {{ if eq $tab "activitat" }}actiu{{ end }}" role="tabpanel" aria-labelledby="tab-activitat">
                            <div class="stats-grid">
                                <div class="card">
                                    <h3>{{ t .Lang "points.profile.total" }}</h3>
                                    <p class="kpi">{{ if .Data.UserPoints }}{{ .Data.UserPoints.Total }}{{ else }}0{{ end }}</p>
                                    <p class="muted">{{ t .Lang "points.profile.updated" }}: {{ if and .Data.UserPoints .Data.UserPoints.UltimaActualitzacio }}{{ .Data.UserPoints.UltimaActualitzacio.Format "2006-01-02" }}{{ else }}—{{ end }}</p>
                                </div>
                            </div>
                            <h3>{{ t .Lang "activity.title" }}</h3>
                            {{ $f := .Data.ActFilter }}
                            <form class="form-filtres" method="get" action="/perfil">
                                <input type="hidden" name="tab" value="activitat">
                                <div class="filtres-grid">
                                    <div class="grup-camp">
                                        <label for="filtre-status">{{ t .Lang "activity.filter.status" }}</label>
                                        <select id="filtre-status" name="status">
                                            <option value="" {{ if eq $f.status "" }}selected{{ end }}>{{ t .Lang "common.all" }}</option>
                                            <option value="pendent" {{ if eq $f.status "pendent" }}selected{{ end }}>{{ t .Lang "activity.status.pendent" }}</option>
                                            <option value="validat" {{ if eq $f.status "validat" }}selected{{ end }}>{{ t .Lang "activity.status.validat" }}</option>
                                            <option value="anulat" {{ if eq $f.status "anulat" }}selected{{ end }}>{{ t .Lang "activity.status.anulat" }}</option>
                                        </select>
                                    </div>
                                    <div class="grup-camp">
                                        <label for="filtre-tipus">{{ t .Lang "activity.filter.type" }}</label>
                                        <select id="filtre-tipus" name="type">
                                            <option value="" {{ if eq $f.type "" }}selected{{ end }}>{{ t .Lang "common.all" }}</option>
                                            <option value="persona" {{ if eq $f.type "persona" }}selected{{ end }}>{{ t .Lang "activity.object.persona" }}</option>
                                            <option value="llibre_pagina" {{ if eq $f.type "llibre_pagina" }}selected{{ end }}>{{ t .Lang "activity.object.llibre_pagina" }}</option>
                                        </select>
                                    </div>
                                    <div class="grup-camp">
                                        <label for="filtre-periode">{{ t .Lang "activity.filter.period" }}</label>
                                        <select id="filtre-periode" name="period">
                                            <option value="" {{ if eq $f.period "" }}selected{{ end }}>{{ t .Lang "common.all" }}</option>
                                            <option value="week" {{ if eq $f.period "week" }}selected{{ end }}>{{ t .Lang "activity.period.week" }}</option>
                                            <option value="month" {{ if eq $f.period "month" }}selected{{ end }}>{{ t .Lang "activity.period.month" }}</option>
                                        </select>
                                    </div>
                                    <div class="grup-camp align-end">
                                        <button type="submit" class="boto-primari">{{ t .Lang "activity.filter.apply" }}</button>
                                    </div>
                                </div>
                            </form>
                            <div class="taula-wrapper">
                                <table class="taula">
                                    <thead>
                                        <tr>
                                            <th>{{ t .Lang "activity.col.date" }}</th>
                                            <th>{{ t .Lang "activity.col.action" }}</th>
                                            <th>{{ t .Lang "activity.col.object" }}</th>
                                            <th>{{ t .Lang "activity.col.status" }}</th>
                                            <th>{{ t .Lang "activity.col.points" }}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{ range .Data.Activities }}
                                        <tr>
                                            <td>{{ .CreatedAt.Format "2006-01-02 15:04" }}</td>
                                            <td>{{ t $.Lang (printf "activity.action.%s" .Action) }}</td>
                                            <td>{{ t $.Lang (printf "activity.object.%s" .ObjectType) }} {{ if .ObjectID.Valid }}#{{ .ObjectID.Int64 }}{{ end }}</td>
                                            <td><span class="badge">{{ t $.Lang (printf "activity.status.%s" .Status) }}</span></td>
                                            <td>{{ .Points }}</td>
                                        </tr>
                                        {{ else }}
                                        <tr><td colspan="5">{{ t .Lang "common.empty" }}</td></tr>
                                        {{ end }}
                                    </tbody>
                                </table>
                            </div>
                        </section>

                        <section id="tab-contrasenya" class="tab-pane {{ if eq $tab "contrasenya" }}actiu{{ end }}" role="tabpanel" aria-labelledby="tab-contrasenya">
                            <form id="form-contrasenya" class="form-vertical" method="post" action="/perfil/contrasenya">
                                <input type="hidden" name="csrf_token" value="{{ .Data.CSRFToken }}">
                                <div class="grup-camp">
                                    <label for="contrasenya-actual">{{ t .Lang "profile.password.current" }}</label>
                                    <div class="input-amb-icona">
                                        <input type="password" id="contrasenya-actual" name="contrasenya_actual" autocomplete="off">
                                        <button type="button" class="boto-icona input-icon" aria-label="Mostra/oculta contrasenya" data-toggle-password="contrasenya-actual">
                                            <i class="far fa-eye"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="grup-camp">
                                    <label for="nova-contrasenya">{{ t .Lang "profile.password.new" }}</label>
                                    <div class="input-amb-icona">
                                        <input type="password" id="nova-contrasenya" name="nova_contrasenya" autocomplete="off">
                                        <button type="button" class="boto-icona input-icon" aria-label="Mostra/oculta contrasenya" data-toggle-password="nova-contrasenya">
                                            <i class="far fa-eye"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="grup-camp">
                                    <label for="confirmar-contrasenya">{{ t .Lang "profile.password.confirm" }}</label>
                                    <div class="input-amb-icona">
                                        <input type="password" id="confirmar-contrasenya" name="confirmar_contrasenya" autocomplete="off">
                                        <button type="button" class="boto-icona input-icon" aria-label="Mostra/oculta contrasenya" data-toggle-password="confirmar-contrasenya">
                                            <i class="far fa-eye"></i>
                                        </button>
                                    </div>
                                </div>

                                <p id="contrasenya-error" class="missatge-error" aria-live="polite"></p>

                                <div class="form-accio">
                                    <button type="submit" class="boto-primari">
                                        <i class="fas fa-key"></i>
                                        <span>Actualitzar contrasenya</span>
                                    </button>
                                </div>
                            </form>
                        </section>

                        <!-- Pestanya: Privacitat -->
                        <section id="tab-privacitat" class="tab-pane {{ if eq $tab "privacitat" }}actiu{{ end }}" role="tabpanel" aria-labelledby="tab-privacitat">
                            <form id="form-privacitat" class="form-vertical" method="post" action="/perfil/privacitat">
                                <input type="hidden" name="csrf_token" value="{{ .Data.CSRFToken }}">
                                <div class="grup-camp">
                                    <h3>{{ t .Lang "profile.privacy.title" }}</h3>
                                    <p class="camp-helper">{{ t .Lang "profile.privacy.helper" }}</p>
                                    <div class="opcions-radi">
                                        <label class="radio-card">
                                            <input type="radio" name="perfil_visibility" value="public" {{ if or (not .Data.Privacy) .Data.Privacy.ProfilePublic }}checked{{ end }}>
                                            <div class="radio-card-contingut">
                                                <h4><i class="fas fa-user"></i> {{ t .Lang "profile.privacy.public.title" }}</h4>
                                                <p>{{ t .Lang "profile.privacy.public.desc" }}</p>
                                            </div>
                                        </label>
                                        <label class="radio-card">
                                            <input type="radio" name="perfil_visibility" value="private" {{ if eq .Data.Privacy.ProfilePublic false }}checked{{ end }}>
                                            <div class="radio-card-contingut">
                                                <h4><i class="fas fa-user-secret"></i> {{ t .Lang "profile.privacy.private.title" }}</h4>
                                                <p>{{ t .Lang "profile.privacy.private.desc" }}</p>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <div class="grup-camp">
                                    <h3>{{ t .Lang "profile.privacy.comms.title" }}</h3>
                                    <div class="llista-checks">
                                        <label class="checkbox-linia">
                                            <input type="checkbox" name="notificacions_correu" {{ if or (not .Data.Privacy) .Data.Privacy.NotifyEmail }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.privacy.comms.email" }}</span>
                                        </label>
                                        <label class="checkbox-linia">
                                            <input type="checkbox" name="contacte_altres_usuaris" {{ if or (not .Data.Privacy) .Data.Privacy.AllowContact }}checked{{ end }}>
                                            <span>{{ t .Lang "profile.privacy.comms.contact" }}</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="form-accio">
                                    <button type="submit" class="boto-primari">
                                        <i class="fas fa-shield-alt"></i>
                                        <span>{{ t .Lang "profile.privacy.save" }}</span>
                                    </button>
                                </div>
                            </form>
                        </section>

                        <!-- Pestanya: Eliminar compte -->
                        <section id="tab-eliminar" class="tab-pane tab-pane-danger {{ if eq $tab "eliminar" }}actiu{{ end }}" role="tabpanel" aria-labelledby="tab-eliminar">
                            <form id="form-eliminar-compte" class="form-vertical form-perill" method="post" action="/perfil/eliminar">
                                <input type="hidden" name="csrf_token" value="{{ .Data.CSRFToken }}">
                                <h3 class="titol-perill"><i class="fas fa-exclamation-triangle"></i> {{ t .Lang "profile.delete.title" }}</h3>
                                <p class="camp-helper">{{ t .Lang "profile.delete.warning" }}</p>

                                <div class="grup-camp">
                                    <label for="eliminar-contrasenya">{{ t .Lang "profile.password.current" }}</label>
                                    <div class="input-amb-icona">
                                        <input type="password" id="eliminar-contrasenya" name="contrasenya_actual" autocomplete="off">
                                        <button type="button" class="boto-icona input-icon" aria-label="Mostra/oculta contrasenya" data-toggle-password="eliminar-contrasenya">
                                            <i class="far fa-eye"></i>
                                        </button>
                                    </div>
                                </div>

                                <label class="checkbox-linia checkbox-perill">
                                    <input type="checkbox" id="confirmar-eliminacio" name="confirmar_eliminacio">
                                    <span>{{ t .Lang "profile.delete.confirm" }}</span>
                                </label>

                                <div class="form-accio">
                                    <button type="submit" class="boto-perill" disabled>
                                        <i class="fas fa-user-slash"></i>
                                        <span>{{ t .Lang "profile.delete.action" }}</span>
                                    </button>
                                </div>
                            </form>
                        </section>
                    </div>
                </div>
            </section>
        </main>

    {{ template "footer" . }}

    {{ template "scripts-private" . }}
    <script src="/static/js/perfil-ajustos.js"></script>
</body>
</html>
{{ end }}
