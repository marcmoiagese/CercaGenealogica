{{ define "municipi-perfil-pro.html" }}
<!DOCTYPE html>
<html lang="{{ .Lang }}">
<head>
    <meta charset="UTF-8">
    <title>{{ t .Lang "municipis.title" }} · {{ .Data.Municipi.Nom }}</title>
    {{ template "styles-private" . }}
    <link rel="stylesheet" href="/static/css/taula.css">
    <link rel="stylesheet" href="/static/css/municipi.css">
    <link rel="stylesheet" href="/static/css/mapes.css">
    <link rel="stylesheet" href="/static/css/municipi-perfil-pro.css">
</head>
<body>
    {{ if .UserLoggedIn }}
        {{ template "header-private" . }}
        {{ template "menu" . }}
    {{ else }}
        {{ template "header-public" . }}
    {{ end }}
    <main class="contingut-principal muni-page">
        <section class="hero">
            <h1>{{ t .Lang "activity.object.municipi" }}: <span id="nomMunicipi">{{ .Data.Municipi.Nom }}</span></h1>
        </section>

        <div class="taula-resultats">
            <div class="barra-superior">
                <button id="configColumnes" class="boto-engranatge"><i class="fas fa-cog"></i></button>
            </div>
            <div class="taula-container">
                <table class="taula taula-registres" id="registresTable">
                    <thead>
                        <tr id="filtraFila">
                            {{ range $i, $col := .Data.RecordColumns }}
                            <th data-col="{{ $i }}" data-key="{{ $col.Key }}">
                                {{ if $col.Filterable }}
                                <input type="text" placeholder="{{ $col.Label }}" data-col="{{ $i }}" data-key="{{ $col.Key }}">
                                {{ end }}
                            </th>
                            {{ end }}
                        </tr>
                        <tr>
                            {{ range $i, $col := .Data.RecordColumns }}
                            <th data-col="{{ $i }}" data-key="{{ $col.Key }}">{{ $col.Label }}</th>
                            {{ end }}
                        </tr>
                    </thead>
                    <tbody id="taulaDades">
                        {{ range $row := .Data.RecordRows }}
                        <tr>
                            {{ range $i, $col := $.Data.RecordColumns }}
                                {{ if $col.IsActions }}
                                <td data-col="{{ $i }}" data-key="{{ $col.Key }}">
                                    <a href="/documentals/registres/{{ $row.ID }}">{{ t $.Lang "records.action.view" }}</a>
                                </td>
                                {{ else if $col.IsStatus }}
                                <td data-col="{{ $i }}" data-key="{{ $col.Key }}">
                                    <span class="badge">{{ t $.Lang (printf "activity.status.%s" $row.ModeracioEstat) }}</span>
                                </td>
                                {{ else }}
                                <td data-col="{{ $i }}" data-key="{{ $col.Key }}">{{ index $row.Cells $col.Key }}</td>
                                {{ end }}
                            {{ end }}
                        </tr>
                        {{ else }}
                        <tr>
                            <td colspan="{{ len .Data.RecordColumns }}">{{ t .Lang "common.empty" }}</td>
                        </tr>
                        {{ end }}
                    </tbody>
                </table>
            </div>
            <div id="paginador" class="paginador"></div>
        </div>

        <div id="modalConfigColumnes" class="modal-config">
            <div class="modal-content-config">
                <span class="tanca-modal-config">&times;</span>
                <h2>{{ t .Lang "records.columns.title" }}</h2>
                <div class="form-group">
                    <label for="filesPerPagina">{{ t .Lang "records.columns.per_page" }}</label>
                    <select id="filesPerPagina">
                        <option value="10">10</option>
                        <option value="25" selected>25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="checkboxes-container" id="llistaColumnes"></div>
            </div>
        </div>

        <div class="muni-grid">
            <aside class="muni-left">
                <section class="card muni-card">
                    <header class="card-header">
                        <h2>{{ t .Lang "maps.title" }}</h2>
                    </header>
                    <div class="muni-map" id="muniMiniMap">
                        <div class="muni-map-empty">
                            <i class="fas fa-map"></i>
                            <div>{{ t .Lang "maps.empty" }}</div>
                        </div>
                    </div>
                </section>

                <section class="card muni-card">
                    <header class="card-header">
                        <h2>{{ t .Lang "municipi.public.section.hierarchy" }}</h2>
                    </header>
                    <ol class="muni-hierarchy" id="muniHierarchy">
                        {{ if .Data.CountryLabel }}
                        <li class="muni-h-item">
                            <span class="muni-h-label">{{ t .Lang "municipis.col.country" }}</span>
                            <span class="muni-h-value">{{ .Data.CountryLabel }}</span>
                        </li>
                        {{ end }}
                        {{ if .Data.Hierarchy }}
                            {{ range .Data.Hierarchy }}
                            <li class="muni-h-item">
                                <span class="muni-h-label">{{ .Tipus }}</span>
                                <span class="muni-h-value">{{ .Nom }}</span>
                                <span class="muted">{{ t $.Lang "levels.col.level" }} {{ .Nivel }}</span>
                            </li>
                            {{ end }}
                        {{ else }}
                            <li class="muni-h-item">{{ t .Lang "common.empty" }}</li>
                        {{ end }}
                    </ol>
                </section>

                <section class="card muni-card muni-callout">
                    <div class="muni-callout-icon"><i class="fas fa-layer-group"></i></div>
                    <div>
                        <h3 class="muni-callout-title">{{ t .Lang "municipi.pro.maps.callout.title" }}</h3>
                        <p class="muted muni-callout-text">{{ t .Lang "municipi.pro.maps.callout.text" }}</p>
                        <div class="muni-callout-actions">
                            <a class="boto-secundari btn-mini" href="/territori/municipis/{{ .Data.Municipi.ID }}/mapes">{{ t .Lang "municipi.pro.maps.cta.all" }}</a>
                            {{ if .UserLoggedIn }}
                            <a class="boto-primari btn-mini" href="/territori/municipis/{{ .Data.Municipi.ID }}/mapes">
                                {{ if .Data.CanCreateMap }}{{ t .Lang "municipi.pro.maps.cta.create" }}{{ else }}{{ t .Lang "municipi.pro.maps.cta.propose" }}{{ end }}
                            </a>
                            {{ end }}
                        </div>
                    </div>
                </section>
            </aside>

            <section class="muni-right">
                <section class="card muni-card muni-maps">
                    <header class="card-header muni-maps-header">
                        <div>
                            <h2>{{ t .Lang "municipi.pro.maps.section.title" }}</h2>
                            <p class="muni-section-subtitle">{{ t .Lang "municipi.pro.maps.section.subtitle" }}</p>
                        </div>
                        <div class="muni-maps-header-actions" aria-label="{{ t .Lang "municipi.pro.maps.section.title" }}">
                            <button class="boto-secundari btn-mini" type="button" id="muniMapPrev" aria-label="{{ t .Lang "municipi.pro.maps.controls.prev" }}">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="boto-secundari btn-mini" type="button" id="muniMapNext" aria-label="{{ t .Lang "municipi.pro.maps.controls.next" }}">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <button class="boto-secundari btn-mini" type="button" id="muniMapsGear" aria-label="{{ t .Lang "municipi.pro.maps.controls.options" }}">
                                <i class="fas fa-gear"></i>
                            </button>
                        </div>
                    </header>

                    <div class="muni-maps-viewport" id="muniMapsViewport" aria-label="{{ t .Lang "maps.viewer.aria" }}" data-empty="{{ t .Lang "maps.empty" }}" data-loading="{{ t .Lang "common.loading" }}" data-chip-default="{{ t .Lang "municipi.pro.maps.viewer.chip" }}">
                        <div class="muni-maps-slides" id="muniMapsSlides"></div>
                        <div class="muni-map-tooltip" id="muniMapTooltip" aria-hidden="true"></div>
                        <div class="muni-maps-chip" id="muniMapsChip">
                            <i class="fas fa-layer-group"></i> <span id="muniMapsChipText">{{ t .Lang "municipi.pro.maps.viewer.chip" }}</span>
                        </div>
                        <div class="muni-maps-popover" id="muniMapsPopover" hidden>
                            <div class="popover-head">
                                <div class="popover-title"><i class="fas fa-sliders"></i> {{ t .Lang "municipi.pro.maps.layers.title" }}</div>
                                <button class="popover-close" type="button" id="muniMapsPopoverClose" aria-label="{{ t .Lang "common.close" }}">
                                    <i class="fas fa-xmark"></i>
                                </button>
                            </div>
                            <div class="popover-grid">
                                <label class="muni-toggle"><span>{{ t .Lang "municipi.pro.maps.layers.houses" }}</span><input type="checkbox" id="optLayerHouses" checked></label>
                                <label class="muni-toggle"><span>{{ t .Lang "municipi.pro.maps.layers.streets" }}</span><input type="checkbox" id="optLayerStreets" checked></label>
                                <label class="muni-toggle"><span>{{ t .Lang "municipi.pro.maps.layers.rivers" }}</span><input type="checkbox" id="optLayerRivers" checked></label>
                                <label class="muni-toggle"><span>{{ t .Lang "municipi.pro.maps.layers.elements" }}</span><input type="checkbox" id="optLayerElements" checked></label>
                                <label class="muni-toggle"><span>{{ t .Lang "municipi.pro.maps.layers.toponyms" }}</span><input type="checkbox" id="optLayerToponyms" checked></label>
                                <label class="muni-toggle"><span>{{ t .Lang "municipi.pro.maps.layers.bounds" }}</span><input type="checkbox" id="optLayerBounds"></label>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="card muni-card muni-history">
                    <header class="card-header">
                        <h2>{{ t .Lang "municipi.history.title" }}</h2>
                    </header>
                    <div class="muni-history-content">
                        <p class="muted muni-history-subtitle">{{ t .Lang "municipi.history.subtitle" }}</p>
                        <div class="muni-history-summary">
                            {{ if .Data.HistoriaGeneral }}
                                {{ if .Data.HistoriaGeneral.Titol }}
                                    <h3 class="muni-history-title">{{ .Data.HistoriaGeneral.Titol }}</h3>
                                {{ else }}
                                    <h3 class="muni-history-title">{{ t .Lang "municipi.history.general" }}</h3>
                                {{ end }}
                                {{ if .Data.HistoriaGeneralSummary }}
                                    <p class="muni-history-text">{{ .Data.HistoriaGeneralSummary }}</p>
                                {{ else }}
                                    <p class="muted">{{ t .Lang "municipi.history.empty_general" }}</p>
                                {{ end }}
                            {{ else }}
                                <h3 class="muni-history-title">{{ t .Lang "municipi.history.general" }}</h3>
                                <p class="muted">{{ t .Lang "municipi.history.empty_general" }}</p>
                            {{ end }}
                        </div>
                        <div class="muni-history-timeline" id="muniTimeline">
                            <h4 class="muni-history-section">{{ t .Lang "municipi.history.timeline" }}</h4>
                            {{ if .Data.HistoriaTimelineDestacat }}
                                <ul class="muni-history-list">
                                    {{ range .Data.HistoriaTimelineDestacat }}
                                        <li class="muni-history-item">
                                            <span class="muni-history-date">{{ .date }}</span>
                                            <span class="muni-history-item-text">{{ .title }}</span>
                                        </li>
                                    {{ end }}
                                </ul>
                            {{ else }}
                                <p class="muted">{{ t .Lang "municipi.history.empty_timeline" }}</p>
                            {{ end }}
                        </div>
                        <div class="muni-history-actions">
                            <a class="boto-secundari btn-mini" id="ctaHistoryAll" href="/territori/municipis/{{ .Data.Municipi.ID }}/historia">{{ t .Lang "municipi.history.view_all" }}</a>
                            {{ if .Data.CanAportarHistoria }}
                                <a class="boto-primari btn-mini" id="ctaAddHistory" href="/territori/municipis/{{ .Data.Municipi.ID }}/historia/aportar">{{ t .Lang "municipi.history.contribute" }}</a>
                            {{ end }}
                        </div>
                    </div>
                </section>
            </section>
        </div>

        <section class="card">
            <header class="card-header">
                <h2>{{ t .Lang "municipi.public.section.archives" }}</h2>
            </header>
            <div class="taula-wrapper">
                <table class="taula">
                    <thead>
                        <tr>
                            <th>{{ t .Lang "archives.col.name" }}</th>
                            <th>{{ t .Lang "archives.col.type" }}</th>
                            <th>{{ t .Lang "archives.col.access" }}</th>
                            <th>{{ t .Lang "archives.col.web" }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{ if .Data.Arxius }}
                            {{ range .Data.Arxius }}
                            <tr>
                                <td><a href="/documentals/arxius/{{ .ID }}">{{ .Nom }}</a></td>
                                <td>{{ t $.Lang (printf "archives.type.%s" .Tipus) }}</td>
                                <td>{{ t $.Lang (printf "archives.access.%s" .Acces) }}</td>
                                <td>{{ if .Web }}<a href="{{ .Web }}" target="_blank">{{ t $.Lang "archives.link" }}</a>{{ else }}-{{ end }}</td>
                            </tr>
                            {{ end }}
                        {{ else }}
                            <tr><td colspan="4">{{ t .Lang "common.empty" }}</td></tr>
                        {{ end }}
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <div id="modalInterconnectar" class="modal-interconnexio" style="display: none;">
        <div class="modal-content-interconnexio">
            <span class="tanca-modal-interconnexio">&times;</span>
            <h3>Interconnectar persona</h3>

            <label for="tipusConnexio">Tipus de connexió:</label>
            <select id="tipusConnexio">
                <option value="">-- Selecciona --</option>
                <option value="pare">Pare</option>
                <option value="mare">Mare</option>
                <option value="avi_patern">Avi patern</option>
                <option value="avia_paterna">Àvia paterna</option>
                <option value="avi_matern">Avi matern</option>
                <option value="avia_materna">Àvia materna</option>
                <option value="pare_adoptiu">Pare adoptiu</option>
                <option value="mare_adoptiva">Mare adoptiva</option>
                <option value="avi_adoptiu">Avi adoptiu</option>
                <option value="avia_adoptiva">Àvia adoptiva</option>
                <option value="mare_de_llet">Mare de llet</option>
                <option value="germans">Germà/Germana</option>
                <option value="germans_llet">Germà de llet</option>
                <option value="padri">Padrí</option>
                <option value="padrina">Padrina</option>
                <option value="matrimoni">Tertimoni matrimoni</option>
                <option value="parella">Parella</option>
            </select>

            <div id="formulariConnexio" style="margin-top: 1em;"></div>
        </div>
    </div>

    {{ template "footer" . }}
    {{ if .UserLoggedIn }}
        {{ template "scripts-private" . }}
    {{ else }}
        {{ template "scripts-public" . }}
    {{ end }}
    <script id="municipiProData" type="application/json">{{ toJsonJS .Data.MapesData }}</script>
    <script src="/static/js/municipi.js"></script>
    <script src="/static/js/cgmap.js"></script>
    <script src="/static/js/municipi-perfil-pro.js"></script>
</body>
</html>
{{ end }}
